<form
  (ngSubmit)="onSubmit()"
  [formGroup]="changePasswordForm"
  class="form"
>
  <div *ngIf="!(isPasswordChangeFinished$ | async) || (error$ | async); else successChange">
    <span class="form__title">Изменение пароля</span>
    <div class="form__subheader">
      Придумайте новый пароль для {{email$ | async}}
    </div>

    <app-input placeholder="Придумайте пароль"
               class="password"
               [formControl]="password"
               (valueChange)="handleInputChange()"
               type="password"></app-input>

    <app-input placeholder="Повторите, чтобы не ошибиться"
               [formControl]="passwordRepeat"
               (valueChange)="handleInputChange()"
               type="password"></app-input>

    <button class="app-button_primary next-button"
            [class.app-button--loading]="isFetching$ | async"
            [disabled]="!changePasswordForm.valid">
      Далее
    </button>

    <div *ngIf="isFormSubmitted && (isPasswordChangeFinished$ | async)" class="result-message">
      <div *ngIf="error$ | async" class="error">{{error$ | async}}</div>
    </div>

    <div [style.margin-top]="'66px'">
      <app-auth-footer></app-auth-footer>
    </div>
  </div>
</form>

<ng-template #successChange>
  <div class="success-container">
    <app-icon
      [width]="'64px'"
      [height]="'64px'"
      icon="check"></app-icon>
    <span class="success-title">Пароль изменен</span>
    <button class="app-button_primary back-button">
      Вернуться на сайт
    </button>
  </div>

  <div class="footer"><app-auth-footer></app-auth-footer></div>
</ng-template>
